# 白屏时间优化
- 需要具体情况具体分析. 应用不同的技术去解决
- 找到问题源,再去解决问题.
## 可能影响白屏时间的因素
- HTTP1.1协议效率低下
- 大量的JS代码重复
- 大量JS代码无差别加载
- 大量的API网络请求
- 没有开启nginx-gzip


### HTTP1.1优化方案
#### HTTP1.1的队头阻塞
- 浏览器针对同一域名可以支持最多6个`TCP`并发连接, 超越这个数字后将发生队头阻塞.
- 针对这一问题,没有别的办法,只能多开域名解决.

#### HTTP1.1的头部臃肿
- 由于HTTP1.1不支持``头部压缩``, 而发送的请求中包含大量的自定义头部, 
- 于是我们借鉴了HTTP2的头部压缩方式, 对自定义头部进行了压缩处理. 大师课(简历优化-优化中的策略与工具)

### 大量的JS代码重复
- 优化方案: 动态提取重复代码.
    1. 如何找到代码中的重复?
    2. 何时提重?
#### 如何找到代码中的重复
- 根据抽象语法树AST, 找到相同的结构, 提取成公共函数,删除多余的代码.算法很复杂.---大师课(简历优化-优化中的策略与工具) 00:35:00
#### 何时提重
- 为了保证效率，提重可以异步延时执行，也可以开启计划任务在服务器空闲时执行，也可以管理员手动执行。

### 大量JS代码无差别加载
- 对这些JS进行差别化加载，视口内需要的先加载，不需要的延迟加载。

### 大量的API网络请求
- 针对性的加入了短时缓存，让相同的请求走缓存通道。

### 使用defer优化白屏时间
- [B站](https://www.bilibili.com/video/BV17ih7z6Erg/?spm_id_from=333.1387.favlist.content.click&vd_source=fd2259d65d6b765562dfc7be43d3480e)
- 核心: dom过多时使用 ``requestAnimationFrame`` ``分帧``渲染dom

### DNS解析和优化
- [B站](https://www.bilibili.com/video/BV1xF8czTEaq/?spm_id_from=333.1387.favlist.content.click&vd_source=fd2259d65d6b765562dfc7be43d3480e)
- DNS解析需要时间. 提前解析所有域名有助于白屏优化
```html
<html>
<head>
	<link rel="dns-prefetch" href="https://www.baidu.com" />
    <link rel="dns-prefetch" href="https://www.autoimg.com" />
</head>
```



